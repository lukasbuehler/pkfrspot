<google-map
  #googleMap
  id="googleMap"
  [center]="center"
  [zoom]="zoom"
  [options]="mapOptions"
  [mapTypeId]="mapTypeId"
  (mapClick)="mapClick.emit($event)"
  (boundsChanged)="emitBoundsChanged()"
  (centerChanged)="emitCenterChanged()"
  (zoomChanged)="getAndEmitChangedZoom()"
  width="100%"
  height="100%"
>
  <map-circle
    *ngFor="let dot of dots"
    [center]="dot"
    [radius]="20"
    [options]="dotCircleOptions"
  ></map-circle>

  <map-circle
    *ngFor="let spot of spots"
    [center]="spot.location"
    [radius]="10"
    [options]="spotCircleOptions"
    (circleClick)="spotClick.emit(spot)"
  >
    <map-polygon
      *ngIf="spot?.hasBounds()"
      #polygon
      [options]="
        spot === selectedSpot && isEditing
          ? spotPolygonEditingOptions
          : spotPolygonOptions
      "
      [paths]="spot.paths"
      (polygonClick)="spotClick.emit(spot)"
    ></map-polygon>
  </map-circle>

  <map-marker
    *ngIf="selectedSpot"
    #selectedSpotMarker
    id="selectedSpotMarker"
    [options]="
      isEditing ? selectedSpotMarkerEditingOptions : selectedSpotMarkerOptions
    "
    [position]="selectedSpot.location"
    (mapDragend)="editingSpotPositionChanged($event.latLng)"
    [title]="selectedSpot.name"
  ></map-marker>
</google-map>

<button mat-mini-fab #mapStyleFab id="mapStyleFab" (click)="toggleMapStyle()">
  <mat-icon aria-label="Button with magnifying lens to search for spots">
    {{ mapOptions.mapTypeId.toLowerCase() === "roadmap" ? "terrain" : "map" }}
  </mat-icon>
</button>
